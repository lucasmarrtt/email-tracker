{% load static %}
{% load socialaccount %}

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Tracker</title>

    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" 
    crossorigin="anonymous" referrerpolicy="no-referrer"/>

</head>
<body>


    <section class="form-container">

        <div class="wrapper">

            <form method="POST" action="">
                {% csrf_token %}
                <h1>Email Tracker</h1>
                <p>"Email Tracker" é uma ferramenta de busca de emails corporativos projetada 
                    para facilitar a identificação<br> e coleta de 
                    endereços de email de empresas e organizações. 
                </p>
                <div class="social-icons">
                    <p>By: <a href="https://www.linkedin.com/in/lucasmarrtt/" target="_blank">Lucas Mart</a></p>
                    <i class="fa-brands fa-linkedin-in"></i>
                </div>
                <div class="input-box">
                    <input {% if request.user.is_anonymous %} id="block-form" {% endif %} type="text" name="search" {% if search_confirm %} value="{{ search }}" {% endif %} autocomplete="off" placeholder="Insira o domínio, Ex:  google.com ...">
                    {% if request.user.is_authenticated %}
                    <button type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
                    {% endif %}
                </div>
    
                
                <div class="remember-forgot">

                    
                   
                    {% if request.user.is_authenticated %}
                    <a class="logout" href="/sign-out">SAIR</a>
                    {% else %}
                    <div class="social-login">
                        <i class="fa-brands fa-google"></i>
                        <a href="{% provider_login_url 'google' %}" > Entrar com Google</a>
                    </div>
                    {% endif %}
                    
                    
                </div>
                

                
    
    
            </form>
    
     
    
        </div>

        
        {% if search_confirm %}
        <div class="content-email">

            <div class="results-detail">
                <h4>Resultados para: &nbsp; <small>{{ domain }}</small></h4>
                <h4>Organização: &nbsp; <small>{% if industry == None %} Sem dados da organização {% else %} {{ industry }} {% endif %}</small></h4>    
            </div>

            <div class="content">


                {% for email in emails %}
                <div class="content-email-loop">
                    <di class="email-detail">
                        <p><i class="fa-solid fa-envelope" style="color: #3e6fca;"></i> &nbsp; <strong>E-mail: </strong>{{ email.value }}</p>
                        <p><i class="fa-solid fa-layer-group"></i> &nbsp; <strong>Tipo: </strong>{{ email.type }}</p>
                        <p><i class="fa-solid fa-circle-check" style="color: {% if email.confidence <= 75 %}  orange; {% elif email.confidence >= 56  %} green; {% endif %}"></i> &nbsp; <strong>Confiança: </strong>{{ email.confidence }}</p>  
                    </di>
                    <p><strong>Fontes: </strong></p>
                    <hr>
                    <ul>
                        {% for source in email.sources %}
                            <li>
                                <p><strong>Domínio: </strong>{{ source.domain }}</p>
                                <p class="p-detail"><strong>URI: </strong>{{ source.uri }}</p>
                                <p class="p-detail"><strong>Extraído em: </strong>{{ source.extracted_on }}</p>
                                <p class="p-detail"><strong>Visto pela última vez em: </strong>{{ source.last_seen_on }}</p>
                                <p class="p-detail"><strong>Está na página: </strong>{{ source.still_on_page }}</p>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endfor %}

           
                
            </div>

        
        </div>

        {% endif %}



    {% comment %}
    <h1>Resultados da Pesquisa de E-mails</h1>
    <p>Domínio: {{ domain }}</p>
    <p>Indústria: {{ industry }}</p>

    <h2>E-mails Encontrados:</h2>
    <div>
        {% for email in emails %}
            <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                <p><strong>E-mail: </strong>{{ email.value }}</p>
                <p><strong>Tipo: </strong>{{ email.type }}</p>
                <p><strong>Confiança: </strong>{{ email.confidence }}</p>
                <p><strong>Fontes: </strong></p>
                <ul>
                    {% for source in email.sources %}
                        <li>
                            <p><strong>Domínio: </strong>{{ source.domain }}</p>
                            <p><strong>URI: </strong>{{ source.uri }}</p>
                            <p><strong>Extraído em: </strong>{{ source.extracted_on }}</p>
                            <p><strong>Visto pela última vez em: </strong>{{ source.last_seen_on }}</p>
                            <p><strong>Está na página: </strong>{{ source.still_on_page }}</p>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    </div>
    {% endcomment %}
    

    


    </section>



 

    

    
    
</body>
</html>